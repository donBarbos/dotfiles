# Mod1=Alt; Mod4=WIN
set $mod Mod1 

font pango: Cascadia Code 11
floating_modifier $mod
default_border pixel
for_window [tiling] border pixel 3

# for HiDPI
output "*" scale 1.7

# keyboard
input * {
    xkb_layout us,ru
    xkb_options grp:shifts_toggle
    xkb_options caps:escape
}

# wallpaper
output * bg ~/Изображения/pictures/wallpaper.jpg fill

# gaps
gaps inner 5
gaps outer 0

# bar
# bar {
#     status_command waybar
#     position top
#     colors {
#         statusline #ffffff
#         background #282828E6
#         inactive_workspace #282936BF #282936BF #5c5c5c
#     }
#     font Cascadia Code 11
# }

for_window [class="lazarus"] floating enable
for_window [title="gnome-calculator"] floating enable
for_window [app_id="(pavucontrol|psensor)"] floating enable
for_window [class="xfce4-power-manager" title="Power Manager"] floating enable
for_window [class="Yad" title="yad-calendar"] floating enable
for_window [title="Authy"] floating enable
for_window [class="^.*"] border pixel 1
for_window [app_id="firefox" title="Firefox — Sharing Indicator"] floating enable
for_window [app_id="firefox" title="Picture-in-Picture"] floating enable
for_window [app_id="firefox" title="Pushbullet – Mozilla Firefox"] floating enable
for_window [app_id="firefox" title="About Mozilla Firefox"] floating enable


bindsym --locked XF86MonBrightnessDown exec brightnessctl set 5%-
bindsym --locked XF86MonBrightnessUp exec brightnessctl set 5%+

bindsym --to-code XF86AudioRaiseVolume exec amixer -q sset Master +5%
bindsym --to-code XF86AudioLowerVolume exec amixer -q sset Master -5%
bindsym --to-code XF86AudioMute exec "~/.config/polybar/scripts/pulseaudio-control.bash togmute``"
bindsym --to-code XF86AudioMicMute exec "~/.config/polybar/scripts/pulseaudio-microphone.sh --toggle &"
# bindsym XF86WLAN exec ""
bindsym --to-code XF86Tools exec "~/code/shell/touchpad_toggle.sh"
# bindsym --to-code XF86Bluetooth exec ""
# bindsym --to-code XF86Favorites exec xfce4-terminal -e "jupyter notebook"
bindsym --to-code XF86Favorites exec "~/.config/polybar/scripts/vpn-wireguard-wg.sh --toggle &"

# start a terminal
for_window [window_role="^floating$"] floating enable
set $menu exec kitty --class Launcher -e sway-launcher-desktop
for_window [app_id="Launcher"] floating enable, border pixel 10, sticky enable
bindsym --to-code $mod+Return exec kitty
#bindsym --to-code $mod+Shift+Return exec kitty --role=floating

# kill focused window
bindsym --to-code $mod+q kill

# start dmenu (a program launcher)
bindsym --to-code ctrl+space exec wofi --show drun

# set keys to change gaps
bindsym --to-code $mod+z gaps outer current plus 5; gaps inner current plus 5
bindsym --to-code $mod+Shift+z gaps outer current minus 5; gaps inner current minus 5

# change focus
bindsym --to-code $mod+h focus left
bindsym --to-code $mod+j focus down
bindsym --to-code $mod+k focus up
bindsym --to-code $mod+l focus right

# move focused window
bindsym --to-code $mod+Shift+h move left
bindsym --to-code $mod+Shift+j move down
bindsym --to-code $mod+Shift+k move up
bindsym --to-code $mod+Shift+l move right

# alternatively, you can use the cursor keys:
bindsym --to-code $mod+Left focus left
bindsym --to-code $mod+Down focus down
bindsym --to-code $mod+Up focus up
bindsym --to-code $mod+Right focus right

# alternatively, you can use the cursor keys:
bindsym --to-code $mod+Shift+Left move left
bindsym --to-code $mod+Shift+Down move down
bindsym --to-code $mod+Shift+Up move up
bindsym --to-code $mod+Shift+Right move right

# split in horizontal orientation
bindsym --to-code Mod4+h split h

# split in vertical orientation
bindsym --to-code Mod4+v split v

bindsym --to-code Mod4+t split toggle

# enter fullscreen mode for the focused container
bindsym --to-code $mod+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym --to-code $mod+s layout stacking
bindsym --to-code $mod+w layout tabbed
bindsym --to-code $mod+e layout toggle split
bindsym --to-code $mod+shift+w sticky toggle

# toggle tiling / floating
bindsym --to-code $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym --to-code $mod+space focus mode_toggle

# focus the parent container
bindsym --to-code $mod+a focus parent

# switch to workspace
bindsym --to-code Mod1+1 workspace 1
bindsym --to-code Mod1+2 workspace 2
bindsym --to-code Mod1+3 workspace 3
bindsym --to-code Mod1+4 workspace 4
bindsym --to-code Mod1+5 workspace 5
bindsym --to-code Mod1+6 workspace 6
bindsym --to-code Mod1+7 workspace 7
bindsym --to-code Mod1+8 workspace 8
bindsym --to-code Mod1+9 workspace 9
bindsym --to-code Mod1+0 workspace 10

# move focused container to workspace
bindsym --to-code Mod1+Shift+1 move container to workspace 1
bindsym --to-code Mod1+Shift+2 move container to workspace 2
bindsym --to-code Mod1+Shift+3 move container to workspace 3
bindsym --to-code Mod1+Shift+4 move container to workspace 4
bindsym --to-code Mod1+Shift+5 move container to workspace 5
bindsym --to-code Mod1+Shift+6 move container to workspace 6
bindsym --to-code Mod1+Shift+7 move container to workspace 7
bindsym --to-code Mod1+Shift+8 move container to workspace 8
bindsym --to-code Mod1+Shift+9 move container to workspace 9
bindsym --to-code Mod1+Shift+0 move container to workspace 10

# reload the configuration file
bindsym --to-code $mod+Shift+r exec sway reload

# bindsym Mod1+g exec google-chrome-stable
# bindsym Mod4+t exec telegram-desktop
# bindsym Mod4+d exec discord
# bindsym Mod4+s exec spotify

bindsym --release --to-code Mod4+p exec "grim -g "" ~/Pictures/screenshots/%s_%H%M_%d%m%Y_$wx$h.png"
bindsym --release --to-code $mod+p exec "grim -g "$(slurp)" ~/Pictures/screenshots/%s_%H%M_%d%m%Y_$wx$h.png"
bindsym --release --to-code $mod+Shift+p exec "grim -g "$(swaymsg -t get_tree | jq -r '.. | select(.focused?) | .rect | "\(.x),\(.y) \(.width)x\(.height)"')" ~/Pictures/screenshots/%s_%H%M_%d%m%Y_$wx$h.png"

bindsym $mod+Shift+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -b 'Yes, exit sway' 'swaymsg exit'
# resize window (you can also use the mouse for that)
mode "resize" {
        # same bindings, but for the arrow keys
        bindsym --to-code Left resize shrink width 5 px or 5 ppt
        bindsym --to-code Down resize grow height 5 px or 5 ppt
        bindsym --to-code Up resize shrink height 5 px or 5 ppt
        bindsym --to-code Right resize grow width 5 px or 5 ppt

        # alternatively, same bindings, but for the arrow keys
        bindsym --to-code h resize shrink width 5 px or 5 ppt
        bindsym --to-code j resize grow height 5 px or 5 ppt
        bindsym --to-code k resize shrink height 5 px or 5 ppt
        bindsym --to-code l resize grow width 5 px or 5 ppt

        # back to normal: Enter or Escape
        bindsym --to-code Return mode "default"
        bindsym --to-code Escape mode "default"
}

bindsym --to-code $mod+r mode "resize"

set $Locker "$HOME/code/shell/lock.sh"

set $mode_system System (l)ock,(e)logout,(r)eboot,(s)uspend,(Shift+s)hutdown
#set $mode_system System (l)ock, (e)logout, (r)eboot, (s)uspend, (h)ibernate (Shift+s)hutdown
mode "$mode_system" {
    bindsym --to-code l exec --no-startup-id $Locker, mode "default"
    bindsym --to-code e exec --no-startup-id i3-msg exit, mode "default"
    # suspend to RAM (recommend for notebook)
    bindsym --to-code s exec --no-startup-id systemctl suspend, mode "default" 
    # suspend to disk
    # bindsym --to-code h exec --no-startup-id systemctl hibernate, mode "default"
    bindsym --to-code r exec --no-startup-id systemctl reboot, mode "default"
    bindsym --to-code Shift+s exec --no-startup-id systemctl poweroff -i, mode "default"  

    # back to normal: Enter or Escape
    bindsym --to-code Return mode "default"
    bindsym --to-code Escape mode "default"
    bindsym --to-code $mod+Delete mode "default"
}

bindsym --to-code $mod+Delete mode "$mode_system"
#exec --no-startup-id xautolock -detectsleep -time 5 -locker 'systemctl suspend'

exec "mako"
exec --no-startup-id "sudo wg-quick up wg0"

exec_always --no-startup-id "~/.config/waybar/launch.sh &"
exec_always --no-startup-id "hda-verb /dev/snd/hwC0D0 0x1d SET_PIN_WIDGET_CONTROL 0x0"
#exec_always nm-applet
#exec_always blueman-applet

#exec pulseaudio-mixer-applet
#exec pnmixer
#exec telegram-desktop
#exec typora
#exec slack
#exec atom
#exec firefox
#exec_always caffeine
#exec_always --no-startup-id xfce4-power-manager

#exec_always xautolock -time 4 -locker "slock" &
#exec --no-startup-id xset dpms 600
#exec xs-lock -- slock

#exec_always xautolock -time 1 -locker "slock" &
#exec_always xautolock -time 2 -locker "systemctl suspend" &
#exec xs-lock -- slock &

#exec --no-startup-id xautolock -time 1 -locker 'i3lock -d -c 111111' &

#it worked
#exec xautolock -time 20 -locker "i3lock-fancy" &
#exec --no-startup-id xautolock -detectsleep -time 20 -locker 'systemctl suspend'

#exec "/usr/local/bin/hotplug_mon.sh"
